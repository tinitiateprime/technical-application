{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/developer/Downloads/Archive/frontend/pages/subject/%5Bsubject%5D.tsx"],"sourcesContent":["\"use client\";\r\nimport { useRouter } from \"next/router\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\ninterface Topics {\r\n  [key: string]: string; // topic name -> markdown content (cached)\r\n}\r\n\r\nexport default function SubjectPage() {\r\n  const router = useRouter();\r\n  const { subject } = router.query;\r\n\r\n  const [topics, setTopics] = useState<Topics>({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const cacheKey = `md-cache-${subject}`;\r\n\r\n  useEffect(() => {\r\n    if (!subject) return;\r\n\r\n    // 1️⃣ Check if subject is already cached\r\n    const cached = localStorage.getItem(cacheKey);\r\n    if (cached) {\r\n      setTopics(JSON.parse(cached));\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // 2️⃣ Fetch data.json → then fetch all markdown for this subject\r\n    fetch(\"/git/data.json\")\r\n      .then(res => res.json())\r\n      .then(async data => {\r\n        const subj = data.subjects[subject as string];\r\n        if (!subj) throw new Error(\"Subject not found\");\r\n\r\n        const fetchedTopics: Topics = {};\r\n\r\n        for (const [topicName, url] of Object.entries(subj)) {\r\n          try {\r\n            const res = await fetch(url);\r\n            if (!res.ok) continue;\r\n            const md = await res.text();\r\n            fetchedTopics[topicName] = md;\r\n          } catch (err) {\r\n            console.error(\"Failed to fetch topic:\", topicName, err);\r\n          }\r\n        }\r\n\r\n        // Cache all topics\r\n        localStorage.setItem(cacheKey, JSON.stringify(fetchedTopics));\r\n        setTopics(fetchedTopics);\r\n        setLoading(false);\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        setError(err.message);\r\n        setLoading(false);\r\n      });\r\n  }, [subject]);\r\n\r\n  if (loading) return <p style={{ padding: 20 }}>Loading topics...</p>;\r\n  if (error) return <p style={{ color: \"red\", padding: 20 }}>{error}</p>;\r\n\r\n  return (\r\n    <div style={{ padding: 40, maxWidth: 900, margin: \"auto\" }}>\r\n      <h1>{subject}</h1>\r\n      {Object.keys(topics).length ? (\r\n        <ul>\r\n          {Object.keys(topics).map(topic => (\r\n            <li key={topic}>\r\n              <a href={`/topic/${encodeURIComponent(topic)}?subject=${encodeURIComponent(subject)}`}>\r\n                {topic}\r\n              </a>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      ) : (\r\n        <p>No topics found for this subject.</p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAQe,SAAS;IACtB,MAAM,SAAS,IAAA,oIAAS;IACxB,MAAM,EAAE,OAAO,EAAE,GAAG,OAAO,KAAK;IAEhC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAS,CAAC;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IAEnC,MAAM,WAAW,CAAC,SAAS,EAAE,SAAS;IAEtC,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,SAAS;QAEd,yCAAyC;QACzC,MAAM,SAAS,aAAa,OAAO,CAAC;QACpC,IAAI,QAAQ;YACV,UAAU,KAAK,KAAK,CAAC;YACrB,WAAW;YACX;QACF;QAEA,iEAAiE;QACjE,MAAM,kBACH,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI,IACpB,IAAI,CAAC,OAAM;YACV,MAAM,OAAO,KAAK,QAAQ,CAAC,QAAkB;YAC7C,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;YAE3B,MAAM,gBAAwB,CAAC;YAE/B,KAAK,MAAM,CAAC,WAAW,IAAI,IAAI,OAAO,OAAO,CAAC,MAAO;gBACnD,IAAI;oBACF,MAAM,MAAM,MAAM,MAAM;oBACxB,IAAI,CAAC,IAAI,EAAE,EAAE;oBACb,MAAM,KAAK,MAAM,IAAI,IAAI;oBACzB,aAAa,CAAC,UAAU,GAAG;gBAC7B,EAAE,OAAO,KAAK;oBACZ,QAAQ,KAAK,CAAC,0BAA0B,WAAW;gBACrD;YACF;YAEA,mBAAmB;YACnB,aAAa,OAAO,CAAC,UAAU,KAAK,SAAS,CAAC;YAC9C,UAAU;YACV,WAAW;QACb,GACC,KAAK,CAAC,CAAA;YACL,QAAQ,KAAK,CAAC;YACd,SAAS,IAAI,OAAO;YACpB,WAAW;QACb;IACJ,GAAG;QAAC;KAAQ;IAEZ,IAAI,SAAS,qBAAO,qKAAC;QAAE,OAAO;YAAE,SAAS;QAAG;kBAAG;;;;;;IAC/C,IAAI,OAAO,qBAAO,qKAAC;QAAE,OAAO;YAAE,OAAO;YAAO,SAAS;QAAG;kBAAI;;;;;;IAE5D,qBACE,qKAAC;QAAI,OAAO;YAAE,SAAS;YAAI,UAAU;YAAK,QAAQ;QAAO;;0BACvD,qKAAC;0BAAI;;;;;;YACJ,OAAO,IAAI,CAAC,QAAQ,MAAM,iBACzB,qKAAC;0BACE,OAAO,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAA,sBACvB,qKAAC;kCACC,cAAA,qKAAC;4BAAE,MAAM,CAAC,OAAO,EAAE,mBAAmB,OAAO,SAAS,EAAE,mBAAmB,UAAU;sCAClF;;;;;;uBAFI;;;;;;;;;qCAQb,qKAAC;0BAAE;;;;;;;;;;;;AAIX"}}]
}